{% extends '@PlateForme/layout.html.twig' %}

{% block body %}
    <style>
        /* uiButton
------------------------ */
.uiButton:link, .uiButton:visited {
	position: relative;
    display: inline-block;
	width: 17em;
	height: 3.4em;
	border-top: 1px solid #b71586;
	border-radius: 3px;
	background: #b71586;
	border-radius: 2px;
	box-shadow: 0 1px 0 rgba(160,18,1175,0.05), 0 0 1px rgba(160,18,1175,0.1), inset 0 1px 2px rgba(0,0,0,0.2);
	z-index: 1;
}
.uiButton:link:before, .uiButton:visited:before {
	position: absolute;
	top: 2px;
	right: 3px;
	bottom: 3px;
	left: 3px;
	padding: .5em 0 0;
	border-radius: 2px;
	background: #ed6802;
	background: -moz-linear-gradient(top, #ce1897, #b71586);
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #ce1897), color-stop(100%,#b71586));/* Android 2.1~3.0 */
	background: -webkit-linear-gradient(top, #ce1897, #b71586);
	background: -o-linear-gradient(top, #ce1897, #b71586);
	background: linear-gradient(to bottom, #ce1897, #b71586);
	box-shadow: inset 0 1px 0 rgba(160,18,117,0.05), inset 0 0 1px rgba(160,18,117,0.1), 0 4px 6px rgba(114,13,84,0.85), 0 1px 2px rgba(114,13,84,0.9);

    color: #ccc;
	font-weight: normal;
	font-size: 132%;
	text-shadow: 0 -1px 1px rgba(0,0,0,0.5);
	text-decoration: none;
	text-transform: uppercase;
	text-align: center;
	letter-spacing: .1em;
	line-height: 1.2;
	content: "nouveau message";
	z-index: 0;
}
.uiButton:hover:before {
	background: #ed6802;
	background: -moz-linear-gradient(top, #ce1897, #b71586);
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #ce1897), color-stop(100%,#b71586));/* Android 2.1~3.0 */
	background: -webkit-linear-gradient(top, #ce1897, #b71586);
	background: -o-linear-gradient(top, #ce1897, #b71586);
	background: linear-gradient(to bottom, #ce1897, #b71586);
	color: #f5f5f5;
}
.uiButton:active:before {
	border-top: 1px solid #720d54;
	background: #ed6802;
	background: -moz-linear-gradient(top, #720d54, #891065);
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #720d54), color-stop(100%,#891065));/* Android 2.1~3.0 */
	background: -webkit-linear-gradient(top, #720d54, #891065);
	background: -o-linear-gradient(top, #720d54, #891065);
	background: linear-gradient(to bottom, #720d54, #891065);
	color: #333;
	box-shadow: inset 0 1px 3px rgba(137,16,101,0.3), inset 0 0 2px rgba(137,16,101,0.6), 0 1px 0 rgba(137,16,101,0.3);
}
/*
*/


    </style>

  <section class="postSectionIndex">
  {# DEBUT CODE #}

    {#-------------------------------------------------------------#}
    {# NavBar Lateral  #}
    {{ include("@Forum/post/postNavBar.html.twig") }}
    {# fin navBar lateral #}
    {#-------------------------------------------------------------#}

  {#-------------------------------------------------------------#}
    {# Mise en place message flash #}
    {% for flash_message in app.session.flashBag.get('notice') %}
        <div class="row container">
            <div class="flash-notice center">
                {{ flash_message }}
            </div>
        </div>
    {% endfor %}
    {#-------------------------------------------------------------#}

  <article class="postArticleIndex">
    <h1 class=" soustitrePage center">Discussions par catégorie</h1>
    <ul class="collapsible popout postDivPrincipale" data-collapsible="popout">
      {#***********************#}
      {# Niveau 1 : Catégories #}
      {#***********************#}
      {% set img = 1 %}
      {% for categorie in categories %}
      <li>
          {# Gestion couleur par catégories #}
          {% if categorie.id == 1 %}
                <div class="collapsible-header postListTitleCat_{{ categorie.id }}">
                    {%  elseif categorie.id == 2%}
                    <div class="collapsible-header postListTitleCat_{{ categorie.id }}">
                        {%  elseif categorie.id == 3 %}
                        <div class="collapsible-header postListTitleCat_{{ categorie.id }}">
                            {%  elseif categorie.id == 4 %}
                            <div class="collapsible-header postListTitleCat_{{ categorie.id }}">
                                {% endif %}
                                {# FIN Gestion couleur par catégories #}

                                {{ categorie.name|capitalize }}

            {# Stockage de l'ID de la CATEGORIE #}
            {% set categorieEnLecture = categorie.id %}
              {# Reprise image categorie du harasBundle #}
              {#<div><img class="indexImageCat" src="{{ asset('bundles/haras/media/section' ~ img ~ 'Image.png') }}"></div>#}
          </div>
          <div class="collapsible-body">
            <ul class="collapsible popout postDivPrincipale" data-collapsible="accordion">
            {#****************************#}
            {# Niveau 2 : SOUS CATEGORIES #}
            {#****************************#}
            {% for sousCategorie in sousCategories %}
            {# Selectionne sous catégorie  parentId not null #}
            {% if sousCategorie.parent.id == categorieEnLecture %}
                <li class="liPostSousCat">
                   <div class="collapsible-header postListTitleSousCat ">
                       <i class="fa fa-bars" aria-hidden="true"></i>
                       {{ sousCategorie.nom|capitalize }}
                       {# Stockage de l'ID de la SOUS CATEGORIE #}
                       {% set sousCategorieEnLecture = sousCategorie.id %}
                   </div>
                   <div class="collapsible-body divCorpsSousCat">
                       <ul class="collapsible popout col offset-l2 l8 s12 m6 postDivPrincipale" data-collapsible="accordion">
                       {#**************************}
                       {# Niveau 3 : Post Parents #}
                       {#*************************#}
                       {% for postParent in postParents %}
                       {# Selectionne sous categorieId du postParent #}
                       {% if (postParent.categorie.id == sousCategorieEnLecture)
                            and (postParent.categorie.parent.id == categorieEnLecture) %}
                            <li>
                                  <div class="collapsible-header postListTitlePost" id="table_id">
                                      <i class="material-icons">place</i>
                                      {{ postParent.titre|capitalize }}
                                      {# Gestion nombre de réponses sur le fil de discussion #}
                                      <span class="badge" data-badge-caption=
                                      {% if nbPostEnfants[postParent.id] == 0 or  nbPostEnfants[postParent.id] == 1 %}"réponse"
                                        {% else %} "réponses"
                                      {% endif %}>
                                          {{ nbPostEnfants[postParent.id] }}
                                      </span>
                                      {# Fin Gestion nombre de réponses sur le fil de discussion #}
                                  </div>
                                  <div class="collapsible-body divCorpsPostParent">
                                      <div class="bigtxt">
                                        {{ postParent.contenu|raw }}
                                          <p>Message posté le {{ postParent.dateCreate|date("d/m/Y") }}</p>

                                      </div>

                                      <div class="chip">
                                        <img src="{{ asset('bundles/haras/images/test2.jpeg')}}" alt="Contact Person">
                                        Message de : {{ postParent.user }}
                                      </div>
                                      <a class="waves-effect waves-teal btn-flat center indexEntrerFil"
                                           href="{{ path('post_showAllPost', { 'id': postParent.id }) }}">
                                            <i class="material-icons">input</i>
                                      </a>
                                  </div> {# fin class="collapsible-body" POSTPARENT #}
                            </li>
                       {% endif %}  {# fin if POST PARENT #}
                       {% endfor %} {# for for POST PARENT #}
                       </ul>
                   <div class="row center">
                       {#Ajout nouveau post parent sur cat & ssCat selectionnées (CAT)#}
                       <a class="uiButton"
                           href="{{ path('post_newParent' , {'cat' : sousCategorieEnLecture}) }}">
                            <i class="material-icons">add</i>
                       </a>
                       {#-------------------------------------------------------------#}
                        {# Mise en place pagination #}
                        {#<div class="row center">#}
                            {#{{ knp_pagination_render(postParents) }}#}
                        {#</div>#}
                        {#-------------------------------------------------------------#}
                   </div>
            {% endif %} {# fin if SOUS CATEGORIE #}
            {% endfor %} {# fin for SOUS CATEGORIE #}
                   </div> {# Fin Div  class="collapsible-body" niveau POST PARENTS #}
                </li>
            </ul>
          </div> {# fin class="collapsible-body" SOUS CATEGORIES #}
      </li>
      {% set img = img + 1 %}
      {% endfor %} {# fin for CATEGORIE #}
    </ul>

   </article>
    {#-------------------------------------------------------------#}
    {# Derniers post  #}
    {{ include("@Forum/post/showDerniersPost.html.twig") }}
    {# fin Derniers post #}
    {#-------------------------------------------------------------#}
</section>
{% endblock %}

{#{% block javascripts %}#}

    {#{{ parent() }}#}

    {#<script>#}
{#$(document).ready(function() {#}
   {#$('header').css('padding-left', '300px');#}
   {#$('.header-logo').css('margin-left', '72px');#}
   {#$('.hide-on-med-and-down').css('margin-left', '70px');#}
   {#$('.page-footer').css( 'margin-left', '300px');#}
   {#$('.page-footer.container').css('margin-left', '-152px');#}
{#});#}
    {#</script>#}

{#{% endblock %}#}